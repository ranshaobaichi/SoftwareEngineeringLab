# PocketLedger 快速使用指南

## 快速开始

### 1. 运行演示程序(推荐)

```bash
python demo.py
```

这将自动演示所有功能:
- ✅ 用户注册和登录
- ✅ 添加多种类型的账目
- ✅ 查询和筛选账目
- ✅ 查看统计分析
- ✅ 设置预算提醒
- ✅ 导出数据

演示完成后会生成:
- `demo_ledger.json` - 演示数据库
- `demo_export.csv` - 导出的CSV文件

### 2. 运行交互式CLI程序

```bash
python main.py
```

按照菜单提示操作:

#### 首次使用 - 注册账户
```
请选择操作:
1. 登录
2. 注册     <- 选择2
0. 退出

输入邮箱、手机号、昵称、密码完成注册
```

#### 登录
```
请选择操作:
1. 登录     <- 选择1
2. 注册
0. 退出

输入邮箱和密码登录
```

#### 主菜单功能
```
主菜单
1. 添加账目      <- 记录一笔收入或支出
2. 查看账目      <- 查询和管理账目
3. 查看统计      <- 查看收支统计
4. 预算管理      <- 设置预算提醒
5. 导出数据      <- 导出为Excel或CSV
6. 个人设置      <- 修改个人信息
0. 退出
```

### 3. 作为Python模块使用

```python
from pocket_ledger import AppLogic
from pocket_ledger.models.category import CategoryType
from decimal import Decimal

# 创建应用实例
app = AppLogic()

# 注册新用户
success, msg, user = app.register(
    email="your@email.com",
    phone="13800138000",
    password="yourpassword",
    nickname="你的昵称"
)

# 登录
success, msg, user = app.login("your@email.com", "yourpassword")

# 获取分类列表
categories = app.get_categories_by_type(CategoryType.EXPENSE)

# 添加一笔支出
success, msg, entry = app.add_entry(
    category_id=categories[0].category_id,
    title="午餐",
    amount=Decimal("35.5"),
    note="公司食堂"
)

# 查询账目
entries = app.query_entries()

# 查看统计
stats = app.get_summary_statistics()
print(f"总收入: ¥{stats['total_income']:.2f}")
print(f"总支出: ¥{stats['total_expense']:.2f}")

# 导出数据
app.export_to_excel("my_ledger.xlsx")
```

## 常用操作示例

### 添加收入记录

```python
from pocket_ledger.models.category import CategoryType

# 获取收入分类
income_cats = app.get_categories_by_type(CategoryType.INCOME)

# 添加工资收入
salary_cat = next(c for c in income_cats if c.name == "工资")
app.add_entry(
    category_id=salary_cat.category_id,
    title="本月工资",
    amount=Decimal("8000.0"),
    note="公司发薪"
)
```

### 按日期查询

```python
from datetime import datetime, timedelta

# 查询最近7天的记录
end_date = datetime.now()
start_date = end_date - timedelta(days=7)

entries = app.query_entries(
    start_date=start_date,
    end_date=end_date
)
```

### 设置月度预算

```python
from pocket_ledger.models.budget import BudgetPeriod

# 设置每月3000元支出预算
app.add_budget(
    period=BudgetPeriod.MONTHLY,
    limit_amount=Decimal("3000.0"),
    threshold_percent=80  # 达到80%时提醒
)

# 检查预算状态
budget_status = app.get_budget_status()
for b in budget_status:
    print(f"已用: {b['percentage']:.1f}%")
    if b['is_threshold_reached']:
        print("⚠️ 预算警告!")
```

### 查看分类统计

```python
# 获取本月的分类统计
from datetime import datetime

now = datetime.now()
start = datetime(now.year, now.month, 1)

cat_stats = app.get_category_statistics(
    start_date=start,
    end_date=now
)

for cat_name, data in cat_stats.items():
    print(f"{cat_name}: ¥{data['amount']:.2f} ({data['count']}笔)")
```

### 导出数据

```python
# 导出为Excel
app.export_to_excel("账目明细.xlsx")

# 导出为CSV
app.export_to_csv("账目明细.csv")

# 导出指定时间范围
from datetime import datetime, timedelta

end = datetime.now()
start = end - timedelta(days=30)  # 最近30天

app.export_to_excel(
    "最近30天账目.xlsx",
    start_date=start,
    end_date=end
)
```

## 预设分类说明

### 支出分类
- 🍔 餐饮 - 日常饮食
- 🛍️ 购物 - 日常购物
- 🚗 交通 - 交通出行
- 🎮 娱乐 - 娱乐休闲
- 💊 医疗 - 医疗健康
- 📚 教育 - 教育学习
- 🏠 住房 - 房租房贷
- 📱 通讯 - 话费网费
- 💸 其他支出

### 收入分类
- 💰 工资 - 工资收入
- 🎁 奖金 - 奖金红包
- 📈 投资收益 - 理财收入
- 💼 兼职 - 兼职收入
- 💵 其他收入

## 数据文件

默认数据文件: `pocket_ledger.json`

数据格式: JSON (自动管理,无需手动编辑)

## 常见问题

### Q: 如何导出Excel文件?

A: 需要安装openpyxl库:
```bash
pip install openpyxl
```

### Q: 如何备份数据?

A: 直接复制 `pocket_ledger.json` 文件即可

### Q: 如何实现图形界面?

A: 参考 `ui_interface.py` 中的 `GUIInterface` 接口,使用PyQt5等框架实现

### Q: 支持多用户吗?

A: 支持。每个用户数据独立存储,通过登录切换用户

### Q: 密码如何存储?

A: 使用SHA256加密,不会存储明文密码

## 更多信息

- 查看 `README.md` 了解项目详情
- 查看 `项目实现报告.md` 了解技术实现
- 运行 `python test_pocket_ledger.py` 运行测试
